var Player=function(t,r){var n=r?r:[],o=this,a=0;this.history=n,this.add=function(t,r){if("object"!=typeof t||Array.isArray(t))n.push({num:r,cnt:t});else for(var a in t)o.add(t[a],a)},this.cards=function(){var t={};for(var r in n)"object"==typeof n[r]&&(t[n[r].num]||(t[n[r].num]=0),t[n[r].num]+=+n[r].cnt,t[n[r].num]<0&&(t[n[r].num]=0));return t},this.cards.total=function(){var t=o.cards(),r=0;for(var n in t)r+=t[n];return r},this.has=function(t,r,n){return n=n?n:o.cards(),n[r]>=t||0===t&&!n[r]?{has:!0,total:n[r]||0}:{has:!1,total:n[r]||0}},this.remove=function(t,r){if("object"!=typeof t||Array.isArray(t))o.add(-t,r);else for(var n in t)o.remove(t[n],n)},this.turn=function(t){t(o.turn.play,o.turn.bs,o.turn.pb)},this.turn.play=function(r,n){o.remove(r,n);var i=t.count();return t.add(r,n),a=t.history.length,t.has(0,n,i).total+r>4?"Call BS!":void 0},this.turn.bs=function(r,n){n===!0?r.add(t.bs(!0)):o.add(t.bs(!1))},this.turn.pb=function(){"PB"!==t.history[a]&&t.pb(a||t.history.length)}};"undefined"!=typeof module&&(module.exports=Player);
var Stack=function(t){var n=t?t:[],o=this;this.history=n,this.add=function(t,r){if("object"!=typeof t||Array.isArray(t))n.push({num:r,cnt:t});else for(var u in t)o.add(t[u],u)},this.bs=function(t){var r=o.count();return n.push(t),r},this.pb=function(t){return t?n.splice(t,0,"PB"):void n.push("PB")},this.count=function(){var t={};for(var o in n)"object"==typeof n[o]?(t[n[o].num]||(t[n[o].num]=0),t[n[o].num]+=+n[o].cnt,t[n[o].num]<0&&(t[n[o].num]=0)):"string"==typeof n[o]&&"PB"===n[o]?t[n[o-1].num]-=+n[o-1].cnt:"boolean"==typeof n[o]&&(t={});return t},this.count.total=function(){var t=o.count(),n=0;for(var r in t)n+=t[r];return n},this.has=function(t,n,r){return r=r?r:o.count(),r[n]>=t||0===t&&!r[n]?{has:!0,total:r[n]||0}:{has:!1,total:r[n]||0}},this.remove=function(t,n){if("object"!=typeof t||Array.isArray(t))o.add(-t,n);else for(var r in t)o.remove(t[r],r)}};"undefined"!=typeof module&&(module.exports=Stack);
var order=[],players={},turn=0,lastTurnIndex=0,stack=new Stack,command=function(r){if(r.match(/(\d+), *(\d+)/g)){var a=players[order[turn%order.length]];if(!a)return"Player not found";var e=order[turn%order.length],t=r.match(/(\d+), *(\d+)/i)[1],n=r.match(/(\d+), *(\d+)/i)[2];return a.turn.play(t,n),turn++,lastTurnIndex=stack.history.length,'Player "'+e+'" played '+t+" "+n+"s"}if(r.match(/Add *Player *(.\D\S*)/i)){var l=r.match(/Add *Player *(.\D\S*)/i)[1];return players[l]=new Player(stack),order.push(l),'Added Player "'+l+'"'}if(r.match(/bs, *(\w*), *(\w*), *(true|false)/i)){var s=r.match(/bs, *(\w*), *(\w*), *(true|false)/i)[1];if(!players[s])return"Player not found";var d=r.match(/bs, *(\w*), *(\w*), *(true|false)/i)[2],u=JSON.parse(r.match(/bs, *(\w*), *(\w*), *(true|false)/i)[3]);return players[s].turn.bs(d,u),u?"Nice Call!":"Better luck next time!"}if(r.match(/pb, *(\w*)/i)){var c=r.match(/pb, *(\w*)/i)[1];return players[c]?(players[c].turn.pb(),"Thanks for telling me!"):"Player not found"}if(r.match(/cards, *(\w*)/i)){var i=r.match(/cards, *(\w*)/i)[1];return"stack"===i?stack.count():players[i]?players[i].cards():"Player not found"}return new Error("Unknown command")};
//# sourceMappingURL=scripts.min.js.map
