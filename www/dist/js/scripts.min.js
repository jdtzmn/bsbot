var Player=function(t,r){var n=r?r:[],a=this,o=0;this.history=n,this.add=function(t,r){if("object"!=typeof t||Array.isArray(t))n.push({num:r,cnt:t});else for(var o in t)a.add(t[o],o)},this.cards=function(){var t={};for(var r in n)"object"==typeof n[r]&&(t[n[r].num]||(t[n[r].num]=0),t[n[r].num]+=+n[r].cnt,t[n[r].num]<0&&(t[n[r].num]=0));return t},this.cards.total=function(){var t=a.cards(),r=0;for(var n in t)r+=t[n];return r},this.has=function(t,r,n){return n=n?n:a.cards(),n[r]>=t||0===t&&!n[r]?{has:!0,total:n[r]||0}:{has:!1,total:n[r]||0}},this.remove=function(t,r){if("object"!=typeof t||Array.isArray(t))a.add(-t,r);else for(var n in t)a.remove(t[n],n)},this.turn=function(t){t(a.turn.play,a.turn.bs,a.turn.pb)},this.turn.play=function(r,n){var i=!1;return a.remove(r,n),+t.has(0,n).total+ +r>4&&(i=!0),t.add(r,n),o=t.history.length,i?"Call BS!":void 0},this.turn.bs=function(r,n){n===!0?r.add(t.bs(!0)):a.add(t.bs(!1))},this.turn.pb=function(){"PB"!==t.history[o]&&t.pb(o||t.history.length)}};"undefined"!=typeof module&&(module.exports=Player);
var Stack=function(t){var n=t?t:[],o=this;this.history=n,this.add=function(t,r){if("object"!=typeof t||Array.isArray(t))n.push({num:r,cnt:t});else for(var u in t)o.add(t[u],u)},this.bs=function(t){var r=o.count();return n.push(t),r},this.pb=function(t){return t?n.splice(t,0,"PB"):void n.push("PB")},this.count=function(){var t={};for(var o in n)"object"==typeof n[o]?(t[n[o].num]||(t[n[o].num]=0),t[n[o].num]+=+n[o].cnt,t[n[o].num]<0&&(t[n[o].num]=0)):"string"==typeof n[o]&&"PB"===n[o]?t[n[o-1].num]-=+n[o-1].cnt:"boolean"==typeof n[o]&&(t={});return t},this.count.total=function(){var t=o.count(),n=0;for(var r in t)n+=t[r];return n},this.has=function(t,n,r){return r=r?r:o.count(),r[n]>=t||0===t&&!r[n]?{has:!0,total:r[n]||0}:{has:!1,total:r[n]||0}},this.remove=function(t,n){if("object"!=typeof t||Array.isArray(t))o.add(-t,n);else for(var r in t)o.remove(t[r],r)}};"undefined"!=typeof module&&(module.exports=Stack);
var order=[],players={},turn=0,lastTurnIndex=0,stack=new Stack,command=function(r){if(r.match(/(\d+), *(\d+)/g)){var e=players[order[turn%order.length]];if(!e)return new Error("Player not found");var a=order[turn%order.length],t=r.match(/(\d+), *(\d+)/i)[1],n=r.match(/(\d+), *(\d+)/i)[2],l=e.turn.play(t,n);return l?l:(turn++,lastTurnIndex=stack.history.length,'Player "'+a+'" played '+t+" "+n+"s")}if(r.match(/Add *Player,? *(\w*)/i)){var s=r.match(/Add *Player,? *(\w*)/i)[1];return players[s]=new Player(stack),order.push(s),'Added Player "'+s+'"'}if(r.match(/bs,? *(\w*),? *(\w*),? *(true|false)/i)){var d=r.match(/bs,? *(\w*),? *(\w*),? *(true|false)/i)[1];if(!players[d])return new Error("Player not found");var u=r.match(/bs,? *(\w*),? *(\w*),? *(true|false)/i)[2],c=JSON.parse(r.match(/bs,? *(\w*),? *(\w*),? *(true|false)/i)[3]);return players[d].turn.bs(players[u],c),c?"Nice Call!":"Better luck next time!"}if(r.match(/pb,? *(\w*)/i)){var o=r.match(/pb,? *(\w*)/i)[1];return players[o]?(players[o].turn.pb(),"Thanks for telling me!"):new Error("Player not found")}if(r.match(/cards,? *(\w*)/i)){var i=r.match(/cards,? *(\w*)/i)[1];return"stack"===i?stack.count():players[i]?players[i].cards():new Erorr("Player not found")}return new Error("Unknown command")};
PNotify.prototype.options.styling="fontawesome",$(document).ready(function(){$("input.command").keyup(function(){var e=!1,s=$("input.command").val();s.match(/(\d+), *(\d+)/g)&&(e=!0),s.match(/Add *Player,? *(\w*)/i)&&(e=!0),s.match(/bs,? *(\w*),? *(\w*),? *(true|false)/i)&&(e=!0),s.match(/pb,? *(\w*)/i)&&(e=!0),s.match(/cards,? *(\w*)/i)&&(e=!0),""===$("input.command").val()?$(this).removeClass("form-control-success").removeClass("form-control-error").parent().removeClass("has-success").removeClass("has-error"):e?$(this).addClass("form-control-success").removeClass("form-control-error").parent().addClass("has-success").removeClass("has-error"):$(this).addClass("form-control-error").removeClass("form-control-success").parent().addClass("has-error").removeClass("has-success")}),$(".submit").click(function(){var e=$("input.command").val(),s=command(e);s instanceof Error?new PNotify({text:s.message,type:"error"}):"object"==typeof s?(new PNotify({text:JSON.stringify(s),type:"info"}),clearTextbox()):(new PNotify({text:s,type:"success"}),clearTextbox())})});var clearTextbox=function(e){$(".submit").prop("disabled",!0).parent().find("input.command").prop("disabled",!0);var s=setInterval(function(){$("input.command").val($("input.command").val().slice(0,-1)),""===$("input.command").val()&&($(".submit").prop("disabled",!1).parent().find("input.command").prop("disabled",!1),clearInterval(s),$("input.command").focus().keyup(),e&&e())},50)};
//# sourceMappingURL=scripts.min.js.map
